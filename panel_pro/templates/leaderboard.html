{% extends "base.html" %}

{% block content %}
<style>
  /* ============================================
     LEADERBOARD â€” Professional Redesign
     ============================================ */

  .lb {
    max-width: 800px;
    margin: 0 auto;
  }

  /* --- Header --- */
  .lb-hero {
    text-align: center;
    margin-bottom: 40px;
  }

  .lb-hero h1 {
    font-size: clamp(2rem, 5vw, 3rem);
    font-weight: 900;
    margin: 0 0 8px;
    background: linear-gradient(135deg, #fbbf24, #f472b6, #a78bfa);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    letter-spacing: -1.5px;
  }

  .lb-hero-sub {
    color: var(--c-text-muted);
    font-size: 1rem;
  }

  /* --- Podium (top 3) --- */
  .podium {
    display: flex;
    align-items: flex-end;
    justify-content: center;
    gap: 16px;
    margin-bottom: 40px;
    padding: 0 20px;
  }

  .podium-slot {
    flex: 1;
    max-width: 200px;
    text-align: center;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  .podium-avatar {
    width: 64px;
    height: 64px;
    border-radius: 50%;
    object-fit: cover;
    border: 3px solid;
    margin-bottom: 12px;
    box-shadow: 0 6px 20px rgba(0,0,0,0.3);
  }

  .podium-avatar-placeholder {
    width: 64px;
    height: 64px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 900;
    color: #fff;
    font-size: 1.2rem;
    margin-bottom: 12px;
    box-shadow: 0 6px 20px rgba(0,0,0,0.3);
    border: 3px solid;
  }

  .podium-name {
    font-weight: 700;
    font-size: 0.95rem;
    color: #fff;
    margin-bottom: 4px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 100%;
  }

  .podium-score {
    font-weight: 900;
    font-size: 1.1rem;
    font-family: 'JetBrains Mono', monospace;
  }

  .podium-pedestal {
    width: 100%;
    border-radius: var(--r-lg) var(--r-lg) 0 0;
    margin-top: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 900;
    font-size: 1.8rem;
    color: rgba(255,255,255,0.3);
  }

  /* 1st place */
  .podium-1 .podium-avatar,
  .podium-1 .podium-avatar-placeholder {
    width: 80px;
    height: 80px;
    border-color: #fbbf24;
  }
  .podium-1 .podium-avatar-placeholder { background: linear-gradient(135deg, #fbbf24, #f59e0b); }
  .podium-1 .podium-score { color: #fbbf24; }
  .podium-1 .podium-pedestal {
    background: linear-gradient(180deg, rgba(251,191,36,0.2), rgba(251,191,36,0.05));
    border: 1px solid rgba(251,191,36,0.2);
    border-bottom: none;
    height: 120px;
  }

  /* 2nd place */
  .podium-2 .podium-avatar,
  .podium-2 .podium-avatar-placeholder {
    border-color: #94a3b8;
  }
  .podium-2 .podium-avatar-placeholder { background: linear-gradient(135deg, #94a3b8, #64748b); }
  .podium-2 .podium-score { color: #94a3b8; }
  .podium-2 .podium-pedestal {
    background: linear-gradient(180deg, rgba(148,163,184,0.15), rgba(148,163,184,0.03));
    border: 1px solid rgba(148,163,184,0.15);
    border-bottom: none;
    height: 90px;
  }

  /* 3rd place */
  .podium-3 .podium-avatar,
  .podium-3 .podium-avatar-placeholder {
    border-color: #cd7f32;
  }
  .podium-3 .podium-avatar-placeholder { background: linear-gradient(135deg, #cd7f32, #a0522d); }
  .podium-3 .podium-score { color: #cd7f32; }
  .podium-3 .podium-pedestal {
    background: linear-gradient(180deg, rgba(205,127,50,0.15), rgba(205,127,50,0.03));
    border: 1px solid rgba(205,127,50,0.15);
    border-bottom: none;
    height: 70px;
  }

  /* --- Remaining Ranks --- */
  .ranks-card {
    background: var(--c-surface);
    backdrop-filter: blur(20px);
    border: 1px solid var(--c-border);
    border-radius: var(--r-2xl);
    overflow: hidden;
  }

  .rank-row {
    display: flex;
    align-items: center;
    gap: 16px;
    padding: 16px 24px;
    border-bottom: 1px solid rgba(255,255,255,0.04);
    transition: background 0.2s;
  }

  .rank-row:last-child {
    border-bottom: none;
  }

  .rank-row:hover {
    background: rgba(255,255,255,0.03);
  }

  .rank-num {
    font-size: 1.1rem;
    font-weight: 900;
    width: 36px;
    text-align: center;
    color: var(--c-text-dim);
    flex-shrink: 0;
  }

  .rank-avatar {
    width: 42px;
    height: 42px;
    border-radius: 50%;
    object-fit: cover;
    border: 2px solid rgba(255,255,255,0.1);
    flex-shrink: 0;
  }

  .rank-avatar-placeholder {
    width: 42px;
    height: 42px;
    border-radius: 50%;
    background: linear-gradient(135deg, #4f46e5, #6366f1);
    display: flex;
    align-items: center;
    justify-content: center;
    color: #fff;
    font-weight: 800;
    font-size: 0.85rem;
    flex-shrink: 0;
  }

  .rank-name {
    font-weight: 700;
    font-size: 1rem;
    color: #fff;
    flex: 1;
    min-width: 0;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }

  .rank-score {
    font-family: 'JetBrains Mono', monospace;
    font-weight: 800;
    font-size: 1.1rem;
    color: #34d399;
    background: rgba(52,211,153,0.1);
    padding: 6px 14px;
    border-radius: var(--r-sm);
    border: 1px solid rgba(52,211,153,0.15);
    flex-shrink: 0;
  }

  /* --- Empty State --- */
  .lb-empty {
    text-align: center;
    padding: 80px 20px;
    background: var(--c-surface);
    border: 1px dashed rgba(255,255,255,0.1);
    border-radius: var(--r-2xl);
  }

  .lb-empty-icon {
    font-size: 3rem;
    opacity: 0.3;
    margin-bottom: 16px;
  }

  .lb-empty h3 {
    font-size: 1.3rem;
    font-weight: 800;
    margin: 0 0 8px;
  }

  .lb-empty p {
    color: var(--c-text-muted);
    font-size: 0.95rem;
    margin: 0;
  }

  .lb-empty code {
    background: rgba(99,102,241,0.15);
    color: var(--c-accent-light);
    padding: 3px 8px;
    border-radius: 6px;
    font-size: 0.85rem;
    font-weight: 700;
  }

  /* --- Responsive --- */
  @media (max-width: 600px) {
    .podium { gap: 10px; }
    .podium-1 .podium-avatar,
    .podium-1 .podium-avatar-placeholder { width: 60px; height: 60px; }
    .podium-avatar,
    .podium-avatar-placeholder { width: 48px; height: 48px; }
    .podium-name { font-size: 0.8rem; }
    .podium-score { font-size: 0.9rem; }
    .podium-1 .podium-pedestal { height: 90px; }
    .podium-2 .podium-pedestal { height: 65px; }
    .podium-3 .podium-pedestal { height: 50px; }
    .rank-row { padding: 14px 18px; gap: 12px; }
    .rank-score { font-size: 0.95rem; padding: 5px 10px; }
  }
</style>

<div class="lb">

  <!-- HEADER -->
  <div class="lb-hero">
    <h1><i class="ph ph-trophy"></i> Classement</h1>
    <p class="lb-hero-sub">Les meilleurs cerveaux du Quiz</p>
  </div>

  {% if scores %}

    <!-- PODIUM (top 3) -->
    {% if scores|length >= 3 %}
    <div class="podium">
      <!-- 2nd -->
      {% set p2 = scores[1] %}
      <div class="podium-slot podium-2">
        {% if p2.avatar %}
          <img src="{{ p2.avatar }}" class="podium-avatar" alt="{{ p2.name }}">
        {% else %}
          <div class="podium-avatar-placeholder">{{ p2.name[:1]|upper }}</div>
        {% endif %}
        <div class="podium-name">{{ p2.name }}</div>
        <div class="podium-score">{{ p2.score }} pts</div>
        <div class="podium-pedestal">2</div>
      </div>

      <!-- 1st -->
      {% set p1 = scores[0] %}
      <div class="podium-slot podium-1">
        {% if p1.avatar %}
          <img src="{{ p1.avatar }}" class="podium-avatar" alt="{{ p1.name }}">
        {% else %}
          <div class="podium-avatar-placeholder">{{ p1.name[:1]|upper }}</div>
        {% endif %}
        <div class="podium-name">{{ p1.name }}</div>
        <div class="podium-score">{{ p1.score }} pts</div>
        <div class="podium-pedestal">1</div>
      </div>

      <!-- 3rd -->
      {% set p3 = scores[2] %}
      <div class="podium-slot podium-3">
        {% if p3.avatar %}
          <img src="{{ p3.avatar }}" class="podium-avatar" alt="{{ p3.name }}">
        {% else %}
          <div class="podium-avatar-placeholder">{{ p3.name[:1]|upper }}</div>
        {% endif %}
        <div class="podium-name">{{ p3.name }}</div>
        <div class="podium-score">{{ p3.score }} pts</div>
        <div class="podium-pedestal">3</div>
      </div>
    </div>
    {% endif %}

    <!-- REMAINING RANKS -->
    {% set remaining = scores[3:] if scores|length > 3 else scores if scores|length < 3 else [] %}
    {% if scores|length < 3 %}
      {% set remaining = scores %}
    {% endif %}

    {% if remaining %}
    <div class="ranks-card">
      {% for p in remaining %}
        <div class="rank-row">
          <div class="rank-num">#{{ loop.index + (3 if scores|length >= 3 else 0) }}</div>
          {% if p.avatar %}
            <img src="{{ p.avatar }}" class="rank-avatar" alt="{{ p.name }}">
          {% else %}
            <div class="rank-avatar-placeholder">{{ p.name[:1]|upper }}</div>
          {% endif %}
          <div class="rank-name">{{ p.name }}</div>
          <div class="rank-score">{{ p.score }} pts</div>
        </div>
      {% endfor %}
    </div>
    {% endif %}

  {% else %}

    <!-- EMPTY STATE -->
    <div class="lb-empty">
      <div class="lb-empty-icon"><i class="ph ph-ghost"></i></div>
      <h3>Aucun score enregistre</h3>
      <p>Lancez un <code>/quiz</code> sur Discord pour etre le premier !</p>
    </div>

  {% endif %}

</div>
{% endblock %}
